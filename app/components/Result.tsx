'use client'
import Highcharts from "highcharts";
import HighchartsReact from "highcharts-react-official";
import HighchartsMore from "highcharts/highcharts-more";
import {Col, Container, Row} from "react-bootstrap";
import getChartOptions from "@/app/logic/ChartOptions";

if (typeof Highcharts === 'object') {
    //that's why: https://www.npmjs.com/package/highcharts-react-official#highcharts-with-nextjs
    HighchartsMore(Highcharts)
}

interface SearchResults {
    name: string
    date: string
    score: string
    tests: string
    graphData: string
}

interface SearchResultsCert {
    searchResults: JSON //TODO: make an object out of it for clarity and to avoid IDE errors
}

export default function Result({searchResults}: SearchResultsCert) {
    // This graph data, when generated by the testing system, might look differently.
    // The production-ready implementation will require adjustments in ChartOptions.ts
    const graphTestData = new Map<string, number>([
        ['Coding Speed', 7.1],
        ['Unit Test', 8],
        ['Implement', 2.5],
        ['Object Orientation', 7.2],
        ['Refactor', 3.2],
        ['Regression', 5.5]
    ])

    return (
        <Container>
            <Row>
                <Col>
                    <h1>Your certification results</h1>
                </Col>
            </Row>
            <Row>
                <Col lg={4} sm={0}/>
                <Col lg={4} sm={12}>
                    <div>
                        <p>Name: {searchResults.name}</p>
                        <p>Date acquired: {searchResults.date}</p>
                        <p>Total Score: {searchResults.score}</p>
                        <p>Tests: {searchResults.testsTaken}</p>
                    </div>
                </Col>
                <Col lg={4} sm={0}/>
            </Row>
            <Row>
                <Col lg={12}>
                    <HighchartsReact
                        highcharts={Highcharts} // possible free alternative: https://www.chartjs.org
                        options={getChartOptions(graphTestData)}
                    />
                </Col>
            </Row>
        </Container>
    )
}